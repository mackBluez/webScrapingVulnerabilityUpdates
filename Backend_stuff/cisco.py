from selenium import webdriver
import csv


chrome_path = r"C:\Automation_OOB\Backend_stuff\chromedriver.exe"
driver = webdriver.Chrome(chrome_path)
driver.get("https://tools.cisco.com/security/center/publicationListing.x")
driver.find_element_by_xpath("""//*[@id="tab-1"]/div[2]/table/tbody[2]/tr[1]/td/table/tbody/tr[1]/td[1]/div/span[4]/a""")
table_cisco = driver.find_elements_by_class_name("advListItem")

data_cisco = []

for vuln in table_cisco:
    data_cisco.append(vuln.text)

'''
#testing
dates_table = []
dates = driver.find_elements_by_xpath("""//*[@id="tab-1"]/div[2]/table/tbody[2]/tr[1]/td/table/tbody/tr[1]/td[4]/span""")
for date in dates:
    dates_table.append(date.text)

print(dates_table)
'''

#writing file 
file = open('C:\\Automation_OOB\\Backend_stuff\\cisco.txt', 'w')
for names in data_cisco:
    file.write(names)
    file.write('\n')
    
print("Cisco Scraped...")
    
driver.quit()

